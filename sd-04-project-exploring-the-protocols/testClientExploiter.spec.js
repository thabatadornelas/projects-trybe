var spawn = require('child_process').spawn

describe('Criar um script utilizando o módulo net capaz de realizar um chamada HTTP a um server', () => {
  it('Será validado que ao fazer a request irá mostrar os dados no console',  (done) => {
    const client = spawn('node', ['exploiters/clientExploiter.js']);
    client.stdout.setEncoding('utf8');

    client.stdout.on('data', function (data) {
      client.kill();
      expect(data).toContain('The document has moved');
      expect(data).toContain('HTTP/1.1 302 Found');
      expect(data).toContain('Content-Type: text/html; charset=UTF-8');
      expect(data).toContain('domain=.google.com.br');
      done();
    });
  });
});
